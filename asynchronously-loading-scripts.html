<!DOCTYPE html><html lang="en"><head><title>Asynchronously Loading Scripts</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Beginner-friendly introduction to loading scripts on to a web page."><meta name="author" content="Robert Pearce"><meta name="keywords" content="javascript, javascript tutorial, asynchronous scripts, website basics"><meta name="google-site-verification" content="QX4bn65yOXBfgnwxlO09yIBc1H8blur-Erx3lmsDVhU"><meta http-equiv="origin-trial" content="Am4BZ0c7GMyB72dgo/Ny2FfIFscXhYMoN+CVe4jduWh24FvsaCwf7kjZzHzfrJXtIilyZVAEKRxOItGLY7lvkAgAAABSeyJvcmlnaW4iOiJodHRwczovL3JvYmVydHdwZWFyY2UuY29tOjQ0MyIsImZlYXR1cmUiOiJQb3J0YWxzIiwiZXhwaXJ5IjoxNjAzNTQ2NDc3fQ=="><meta property="og:site_name" content="Robert Pearce"><meta property="og:title" content="Asynchronously Loading Scripts"><meta property="og:url" content="https://robertwpearce.com/asynchronously-loading-scripts.html"><meta property="og:description" content="Beginner-friendly introduction to loading scripts on to a web page."><meta property="og:type" content="article"><meta property="twitter:site" content="Robert Pearce"><meta property="twitter:title" content="Asynchronously Loading Scripts"><meta property="twitter:description" content="Beginner-friendly introduction to loading scripts on to a web page."><meta property="twitter:creator" content="@RobertWPearce"><link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üíæ</text></svg>"><link rel="canonical" href="https://robertwpearce.com/asynchronously-loading-scripts.html"><link rel="alternate" href="./atom.xml" title="Robert Pearce's blog" type="application/atom+xml"><link rel="alternate" href="./rss.xml" title="Robert Pearce's blog" type="application/rss+xml"><link rel="stylesheet" href="./css/base.css"><link rel="stylesheet" href="./css/t-clean.css"><link rel="stylesheet" href="./css/t-clean-note.css"><link rel="stylesheet" href="./css/t-code-dracula.css"><link rel="prefetch" href="./css/t-clean-note.css"></head><body data-theme="clean-night"><script> (() => { window.site = { prefFont: localStorage.getItem('prefFont') || 'monospace', setFont: (family) => { localStorage.setItem('prefFont', family); const rootStyle = document.querySelector(':root').style; rootStyle.setProperty('--type-family-body', family+',monospace'); /* Remove when https://github.com/googlefonts/spacemono/pull/2 is resolved */ if (family === 'Liga Space Mono') { rootStyle.setProperty('font-feature-settings', '"liga" 0'); } else { rootStyle.removeProperty('font-feature-settings'); } return window.site._fetchFont(family); }, prefTheme: localStorage.getItem('prefTheme') || (matchMedia('(prefers-color-scheme: dark)').matches ? 'clean-night' : 'clean-day'), setTheme: (name) => { const rootStyle = document.querySelector(':root').style; if (name === 'clean-night') { rootStyle.removeProperty('color-scheme'); } else { rootStyle.setProperty('color-scheme', 'light'); } document.body.setAttribute('data-theme', name); localStorage.setItem('prefTheme', name); }, _fetchFont: (family) => { if (family === 'monospace') { return Promise.resolve(); } const familyNoSpaces = family.replaceAll(' ', ''); const fontz = [ new FontFace(family, 'url("./fonts/'+familyNoSpaces+'-Regular.woff2") format("woff2")', { display: 'swap', weight: 400 }), new FontFace(family, 'url("./fonts/'+familyNoSpaces+'-Bold.woff2") format("woff2")', { display: 'swap', weight: 700 }), ]; if (family !== 'Fira Code') { fontz.push( new FontFace(family, 'url("./fonts/'+familyNoSpaces+'-Italic.woff2") format("woff2")', { display: 'swap', style: 'italic', weight: 400 }), new FontFace(family, 'url("./fonts/'+familyNoSpaces+'-BoldItalic.woff2") format("woff2")', { display: 'swap', style: 'italic', weight: 700 }) ); } for (const f of fontz) { document.fonts.add(f); } return Promise.allSettled(fontz).then(results => { results.forEach((res, i) => { if (res.status === 'rejected') { console.error('site failed to load font: ' + fontz[i]?.family ?? 'unknown'); } }); }); } }; window.site.setTheme(window.site.prefTheme); window.site.setFont(window.site.prefFont); })(); </script><header><nav><div class="nav-skip"><a href="#content">Skip to content</a></div><a aria-label="Home" class="nav-home" href="./">~</a><span>/</span></nav><div class="header-extra"><a href="./atom.xml">RSS</a><span aria-hidden="true">&compfn;</span><noscript>(requires JS &rarr;)</noscript><label for="select-theme">Theme</label><select data-select-theme id="select-theme"><option value="clean-day">Clean (Day)</option><option value="clean-night">Clean (Night)</option></select><span aria-hidden="true">&compfn;</span><label for="select-font">Font</label><select data-select-font id="select-font"><option value="monospace">monospace</option><option value="Liga Space Mono">Space Mono</option><option value="Victor Mono">Victor Mono</option><option value="Fira Code">Fira Code</option><option value="JetBrains Mono">JetBrains Mono</option></select></div></header><main id="content"><header data-area="heading"><h1>Asynchronously Loading Scripts</h1></header><section data-area="meta"><h2>Info</h2><table data-type="cols-y"><tbody><tr><th>Summary</th><td>Beginner-friendly introduction to loading scripts on to a web page.</td></tr><tr><th>Shared</th><td>2015-10-05</td></tr><tr><th>Revised</th><td>2023-02-04 @ 18:00 UTC</td></tr></tbody></table></section><section data-area="note"><p><em>This article is intended for HTML &amp; JavaScript beginners.</em></p><p><em>2023 update: This article, while still good, doesn‚Äôt take into account the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script#attr-defer">defer</a>, attribute. <a href="https://javascript.info/script-async-defer">Here is a great javascript.info article on async vs. defer</a>.</em></p><hr /><p>Where do you place your <code>&lt;script&gt;</code> tags to load your JavaScript for your website? If you‚Äôre doing this within the <code>&lt;head&gt;</code> element, you might want to consider whether or not this is the best option for you.</p><h2 id="fetching-javascript-synchronously">Fetching JavaScript Synchronously</h2><p>So long as HTTP/1.1 is what your website is accessed via (which it will be a long while), <code>&lt;script&gt;</code> tags will be used to fetch external JavaScript files whose contents will be included on the page. These typically look like <code>&lt;script src="app.js"&gt;&lt;/script&gt;</code>. <code>&lt;script&gt;</code> tags are by default ‚Äúblocking,‚Äù meaning that the web page has to pause its download &amp; render cycle, fetch and load the JavaScript and then continue on. Here is what this looks like:</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-p">&lt;</span><span class="pl-nt">html</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;</span><span class="pl-nt">head</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-p">&lt;</span><span class="pl-nt">script</span> <span class="pl-na">src</span><span class="pl-o">=</span><span class="pl-s">"app.js"</span><span class="pl-p">&gt;&lt;/</span><span class="pl-nt">script</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;/</span><span class="pl-nt">head</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;</span><span class="pl-nt">body</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-p">&lt;</span><span class="pl-nt">div</span><span class="pl-p">&gt;</span>My Website<span class="pl-p">&lt;/</span><span class="pl-nt">div</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;/</span><span class="pl-nt">body</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">&lt;/</span><span class="pl-nt">html</span><span class="pl-p">&gt;</span></span></span></code></pre><p>The worst thing you can do is load multiple scripts in this blocking fashion:</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-p">&lt;</span><span class="pl-nt">html</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;</span><span class="pl-nt">head</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-p">&lt;</span><span class="pl-nt">script</span> <span class="pl-na">src</span><span class="pl-o">=</span><span class="pl-s">"jquery.js"</span><span class="pl-p">&gt;&lt;/</span><span class="pl-nt">script</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-p">&lt;</span><span class="pl-nt">script</span> <span class="pl-na">src</span><span class="pl-o">=</span><span class="pl-s">"jquery.lightbox.js"</span><span class="pl-p">&gt;&lt;/</span><span class="pl-nt">script</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-p">&lt;</span><span class="pl-nt">script</span> <span class="pl-na">src</span><span class="pl-o">=</span><span class="pl-s">"some_file.js"</span><span class="pl-p">&gt;&lt;/</span><span class="pl-nt">script</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-p">&lt;</span><span class="pl-nt">script</span> <span class="pl-na">src</span><span class="pl-o">=</span><span class="pl-s">"app.js"</span><span class="pl-p">&gt;&lt;/</span><span class="pl-nt">script</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;/</span><span class="pl-nt">head</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;</span><span class="pl-nt">body</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-p">&lt;</span><span class="pl-nt">div</span><span class="pl-p">&gt;</span>My Website<span class="pl-p">&lt;/</span><span class="pl-nt">div</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;/</span><span class="pl-nt">body</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">&lt;/</span><span class="pl-nt">html</span><span class="pl-p">&gt;</span></span></span></code></pre><p>so make sure you combine (concatenate) all your JavaScript files in to one file. But this is still not ideal, for you have a blocking script that will have to download before anything else happens.</p><p>When we throw <code>&lt;script&gt;</code> tags at the end of the <code>&lt;body&gt;</code>, we allow for the page to paint and then go and fetch the JS synchronously (this lets the user see and utilize the page, but the scripts still haven‚Äôt finished loading).</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-p">&lt;</span><span class="pl-nt">html</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;</span><span class="pl-nt">head</span><span class="pl-p">&gt;&lt;/</span><span class="pl-nt">head</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;</span><span class="pl-nt">body</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-p">&lt;</span><span class="pl-nt">div</span><span class="pl-p">&gt;</span>My Website<span class="pl-p">&lt;/</span><span class="pl-nt">div</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-p">&lt;</span><span class="pl-nt">script</span> <span class="pl-na">src</span><span class="pl-o">=</span><span class="pl-s">"app.js"</span><span class="pl-p">&gt;&lt;/</span><span class="pl-nt">script</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">&lt;/</span><span class="pl-nt">body</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">&lt;/</span><span class="pl-nt">html</span><span class="pl-p">&gt;</span></span></span></code></pre><p>However, since the page is still loading, search engines might punish you for a long(er) loading time. What we might need, instead, is the ability to asynchronously fetch the JavaScript <em>after</em> the page is finished loading.</p><h2 id="fetching-javascript-asynchronously">Fetching JavaScript Asynchronously</h2><p>There are two popular methods for fetch JavaScript in an asynchronous manner.</p><p>The first is to simply include the HTML5 <code>async</code> property:</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-p">&lt;</span><span class="pl-nt">script</span> <span class="pl-na">src</span><span class="pl-o">=</span><span class="pl-s">"app.js"</span> <span class="pl-na">async</span><span class="pl-p">&gt;&lt;/</span><span class="pl-nt">script</span><span class="pl-p">&gt;</span></span></span></code></pre><p>Or, if you need to support older browsers, add an event listener to the window‚Äôs <code>load</code> function to dynamically build a script tag and append it to the page (note how I do not use <code>window.onload =</code>):</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-p">&lt;</span><span class="pl-nt">script</span><span class="pl-p">&gt;</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-nb">window</span><span class="pl-p">.</span><span class="pl-nx">addEventListener</span><span class="pl-p">(</span><span class="pl-s1">'load'</span><span class="pl-p">,</span> <span class="pl-nx">buildScriptTag</span><span class="pl-p">);</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-kd">function</span> <span class="pl-nx">buildScriptTag</span><span class="pl-p">()</span> <span class="pl-p">{</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-kd">var</span> <span class="pl-nx">script</span> <span class="pl-o">=</span> <span class="pl-nb">document</span><span class="pl-p">.</span><span class="pl-nx">createElement</span><span class="pl-p">(</span><span class="pl-s1">'script'</span><span class="pl-p">);</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-nx">script</span><span class="pl-p">.</span><span class="pl-nx">src</span> <span class="pl-o">=</span> <span class="pl-s1">'app.js'</span><span class="pl-p">;</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-nb">document</span><span class="pl-p">.</span><span class="pl-nx">body</span><span class="pl-p">.</span><span class="pl-nx">appendChild</span><span class="pl-p">(</span><span class="pl-nx">script</span><span class="pl-p">);</span> <span class="pl-c1">// append it wherever you want
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span>  <span class="pl-p">}</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">&lt;/</span><span class="pl-nt">script</span><span class="pl-p">&gt;</span></span></span></code></pre><p>Why didn‚Äôt I use <code>window.onload =</code> here? When you assign a browser callback trigger a value, it can only have one value! When you add an event listener, you allow the window‚Äôs load functionality to have more values in the future.</p><h2 id="conclusion">Conclusion</h2><p>If your app/website is architected to rely on JavaScript before it renders anything, then you can utilize this asynchronous technique with a ‚ÄúLoading‚Ä¶‚Äù graphic that is removed when the JavaScript loads. Ultimately, you want to decrease the amount of time it takes for a web page to perform an initial load so that the user can get started using your project as quickly as possible. With asynchronous loading of JavaScript, you enable your users to get going ASAP and then allow for them to have a fancier experience once things load in the background.</p></section></main><footer><span aria-hidden="true" class="heart">‚ô•</span><span aria-hidden="true">&rarr;</span><a href="https://github.com/sponsors/rpearce/">Sponsor my work</a><span aria-hidden="true">&larr;</span><span aria-hidden="true" class="heart">‚ô•</span></footer><script async> (() => { const themeEl = document.querySelector('[data-select-theme]'); if (themeEl) { themeEl.querySelector('[value="'+window.site.prefTheme+'"]').selected = 'selected'; themeEl.addEventListener('change', e => { window.site.setTheme(e.target.value); }); } const fontEl = document.querySelector('[data-select-font]'); if (fontEl) { fontEl.querySelector('[value="'+window.site.prefFont+'"]').selected = 'selected'; fontEl.addEventListener('change', e => { window.site.setFont(e.target.value); }) } })(); </script></body></html>