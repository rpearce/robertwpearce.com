<!DOCTYPE html><html lang="en"><head><title>Immediate Functions</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Beginner-friendly introduction to immediate functions."><meta name="author" content="Robert Pearce"><meta name="keywords" content="javascript, javascript tutorial, immediate functions, IIFE, kelvin to fahrenheit"><meta name="google-site-verification" content="QX4bn65yOXBfgnwxlO09yIBc1H8blur-Erx3lmsDVhU"><meta http-equiv="origin-trial" content="Am4BZ0c7GMyB72dgo/Ny2FfIFscXhYMoN+CVe4jduWh24FvsaCwf7kjZzHzfrJXtIilyZVAEKRxOItGLY7lvkAgAAABSeyJvcmlnaW4iOiJodHRwczovL3JvYmVydHdwZWFyY2UuY29tOjQ0MyIsImZlYXR1cmUiOiJQb3J0YWxzIiwiZXhwaXJ5IjoxNjAzNTQ2NDc3fQ=="><meta property="og:site_name" content="Robert Pearce"><meta property="og:title" content="Immediate Functions"><meta property="og:url" content="https://robertwpearce.com/immediate-functions.html"><meta property="og:description" content="Beginner-friendly introduction to immediate functions."><meta property="og:type" content="article"><meta property="twitter:site" content="Robert Pearce"><meta property="twitter:title" content="Immediate Functions"><meta property="twitter:description" content="Beginner-friendly introduction to immediate functions."><meta property="twitter:creator" content="@RobertWPearce"><link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üíæ</text></svg>"><link rel="canonical" href="https://robertwpearce.com/immediate-functions.html"><link rel="alternate" href="./atom.xml" title="Robert Pearce's blog" type="application/atom+xml"><link rel="alternate" href="./rss.xml" title="Robert Pearce's blog" type="application/rss+xml"><link rel="stylesheet" href="./css/base.css"><link rel="stylesheet" href="./css/t-clean.css"><link rel="stylesheet" href="./css/t-clean-note.css"><link rel="stylesheet" href="./css/t-code-dracula.css"><link rel="prefetch" href="./css/t-clean-note.css"></head><body data-theme="clean-night"><script> (() => { window.site = { prefFont: localStorage.getItem('prefFont') || 'monospace', setFont: (family) => { localStorage.setItem('prefFont', family); const rootStyle = document.querySelector(':root').style; rootStyle.setProperty('--type-family-body', family+',monospace'); /* Remove when https://github.com/googlefonts/spacemono/pull/2 is resolved */ if (family === 'Liga Space Mono') { rootStyle.setProperty('font-feature-settings', '"liga" 0'); } else { rootStyle.removeProperty('font-feature-settings'); } return window.site._fetchFont(family); }, prefTheme: localStorage.getItem('prefTheme') || (matchMedia('(prefers-color-scheme: dark)').matches ? 'clean-night' : 'clean-day'), setTheme: (name) => { const rootStyle = document.querySelector(':root').style; if (name === 'clean-night') { rootStyle.removeProperty('color-scheme'); } else { rootStyle.setProperty('color-scheme', 'light'); } document.body.setAttribute('data-theme', name); localStorage.setItem('prefTheme', name); }, _fetchFont: (family) => { if (family === 'monospace') { return Promise.resolve(); } const familyNoSpaces = family.replaceAll(' ', ''); const fontz = [ new FontFace(family, 'url("./fonts/'+familyNoSpaces+'-Regular.woff2") format("woff2")', { display: 'swap', weight: 400 }), new FontFace(family, 'url("./fonts/'+familyNoSpaces+'-Bold.woff2") format("woff2")', { display: 'swap', weight: 700 }), ]; if (family !== 'Fira Code') { fontz.push( new FontFace(family, 'url("./fonts/'+familyNoSpaces+'-Italic.woff2") format("woff2")', { display: 'swap', style: 'italic', weight: 400 }), new FontFace(family, 'url("./fonts/'+familyNoSpaces+'-BoldItalic.woff2") format("woff2")', { display: 'swap', style: 'italic', weight: 700 }) ); } for (const f of fontz) { document.fonts.add(f); } return Promise.allSettled(fontz).then(results => { results.forEach((res, i) => { if (res.status === 'rejected') { console.error('site failed to load font: ' + fontz[i]?.family ?? 'unknown'); } }); }); } }; window.site.setTheme(window.site.prefTheme); window.site.setFont(window.site.prefFont); })(); </script><header><nav><div class="nav-skip"><a href="#content">Skip to content</a></div><a aria-label="Home" class="nav-home" href="./">~</a><span>/</span></nav><div class="header-extra"><a href="./atom.xml">RSS</a><span aria-hidden="true">&compfn;</span><noscript>(requires JS &rarr;)</noscript><label for="select-theme">Theme</label><select data-select-theme id="select-theme"><option value="clean-day">Clean (Day)</option><option value="clean-night">Clean (Night)</option></select><span aria-hidden="true">&compfn;</span><label for="select-font">Font</label><select data-select-font id="select-font"><option value="monospace">monospace</option><option value="Liga Space Mono">Space Mono</option><option value="Victor Mono">Victor Mono</option><option value="Fira Code">Fira Code</option><option value="JetBrains Mono">JetBrains Mono</option></select></div></header><main id="content"><header data-area="heading"><h1>Immediate Functions</h1></header><section data-area="meta"><h2>Info</h2><table data-type="cols-y"><tbody><tr><th>Summary</th><td>Beginner-friendly introduction to immediate functions.</td></tr><tr><th>Shared</th><td>2015-10-06</td></tr></tbody></table></section><section data-area="note"><p><em>This article is intended for JavaScript beginners.</em></p><p>The browser environment is one big JavaScript <code>closure</code> that will encapsulate in its <code>scope</code> all of the code that is to be run. Because of this, any functions or variables that are created in <code>&lt;script&gt;</code> tags or external <code>.js</code> files that are <em>not</em> defined within a function will end up as global variables! And we all know that global varibles are bad. Let‚Äôs dig in to this some more.</p><p>Every time you define a function and then define a variable with <code>var</code> inside of that function, that variable <em>only</em> exists inside of that function. For example, what is the value of <code>result</code> that is logged to the console?</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-c1">// app.js
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span><span class="pl-kd">function</span> <span class="pl-nx">kelvinToFahrenheit</span><span class="pl-p">(</span><span class="pl-nx">kelvin</span><span class="pl-p">)</span> <span class="pl-p">{</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-kd">var</span> <span class="pl-nx">result</span> <span class="pl-o">=</span> <span class="pl-nb">Math</span><span class="pl-p">.</span><span class="pl-nx">round</span><span class="pl-p">(</span><span class="pl-nx">kelvin</span> <span class="pl-o">*</span> <span class="pl-p">(</span><span class="pl-mi">9</span><span class="pl-o">/</span><span class="pl-mi">5</span><span class="pl-p">)</span> <span class="pl-o">-</span> <span class="pl-mf">459.67</span><span class="pl-p">);</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-k">return</span> <span class="pl-nx">result</span><span class="pl-p">;</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">}</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-nx">kelvinToFahrenheit</span><span class="pl-p">(</span><span class="pl-mf">274.3</span><span class="pl-p">);</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-nx">console</span><span class="pl-p">.</span><span class="pl-nx">log</span><span class="pl-p">(</span><span class="pl-nx">result</span><span class="pl-p">);</span></span></span></code></pre><p>The correct answer would be <code>undefined</code> (with a nice error), for <code>result</code> only exists within the <code>scope</code> of the <code>kelvinToFahrenheit</code> function. However, the function <code>kelvinToFahrenheit</code> now exists globally.</p><p>Why does this matter? Well, when you include a script on to a web page, its code now becomes part of this global closure. So if you define <code>function kelvinToFahrenheit()</code> without giving it a separate closure or namespace (more on namespaces in a second), then it is now a ‚Äúglobal function,‚Äù meaning that it exists in the global namespace. If any other library you ever include uses a variable called <code>router</code>, your variable (or that library‚Äôs) is going to overwrite whichever came before it and cause massive issues. The same thing is true for variables:</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-c1">// app.js
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span><span class="pl-kd">var</span> <span class="pl-nx">currentTempInKelvin</span> <span class="pl-o">=</span> <span class="pl-mf">294.11</span><span class="pl-p">;</span></span></span></code></pre><p>So what are your options?</p><h2 id="immediately-invoked-function-expressions-iifes">Immediately Invoked Function Expressions (IIFEs)</h2><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-c1">// app.js
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span><span class="pl-p">;(</span><span class="pl-kd">function</span><span class="pl-p">()</span> <span class="pl-p">{</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-c1">// your code here
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span><span class="pl-p">})();</span></span></span></code></pre><p>The semi-colon here is a defensive technique used for when files are concatenated together‚Äìif somebody in one file forgets to close their file/library/definition out with a semi-colon, then your code is going to be an extension of theirs.</p><p>The <code>()</code> towards the end is nothing more than the invocation of the immediate function we‚Äôve defined.</p><p>Thus, when you write</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-c1">// app.js
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span><span class="pl-p">;(</span><span class="pl-kd">function</span><span class="pl-p">()</span> <span class="pl-p">{</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-kd">var</span> <span class="pl-nx">currentTempInKelvin</span> <span class="pl-o">=</span> <span class="pl-mf">294.11</span><span class="pl-p">;</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">})();</span></span></span></code></pre><p>and then you try to <code>console.log(currentTempInKelvin);</code> from the browser‚Äôs JavaScript console, you will get <code>undefined</code>, for <code>currentTempInKelvin</code> now only exists within that anonymous function‚Äôs scope. Hurray! No more globals.</p><hr /><p>But what if we want to access something in a global fashion? We know about the problems of name-clashing, so let‚Äôs also try to reduce that. Let‚Äôs combine what you did with the immediate function and do global variables in a less-bad way using <em>namespacing</em>.</p><h2 id="namespacing">Namespacing</h2><p>Namespacing allows us to limit our use of global variables to one global by nesting all of our functionality within one global object that we‚Äôll call <code>WeatherApp</code>.</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-c1">// app.js
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1">// No var declaration means global!
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span><span class="pl-p">;(</span><span class="pl-kd">function</span><span class="pl-p">()</span> <span class="pl-p">{</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-nx">WeatherApp</span> <span class="pl-o">=</span> <span class="pl-p">{</span>
</span></span><span class="pl-line"><span class="pl-cl">    <span class="pl-nx">kelvinToFahrenheit</span><span class="pl-o">:</span> <span class="pl-p">{}</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-p">};</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">})();</span></span></span></code></pre><p>or</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-c1">// app.js
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span><span class="pl-p">;(</span><span class="pl-kd">function</span><span class="pl-p">()</span> <span class="pl-p">{</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-nx">WeatherApp</span> <span class="pl-o">=</span> <span class="pl-p">{};</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-nx">WeatherApp</span><span class="pl-p">.</span><span class="pl-nx">kelvinToFahrenheit</span> <span class="pl-o">=</span> <span class="pl-p">{};</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">})();</span></span></span></code></pre><p>or (better)</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-c1">// app.js
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span><span class="pl-p">;(</span><span class="pl-kd">function</span><span class="pl-p">()</span> <span class="pl-p">{</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-nb">window</span><span class="pl-p">.</span><span class="pl-nx">WeatherApp</span> <span class="pl-o">=</span> <span class="pl-p">{};</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-nb">window</span><span class="pl-p">.</span><span class="pl-nx">WeatherApp</span><span class="pl-p">.</span><span class="pl-nx">kelvinToFahrenheit</span> <span class="pl-o">=</span> <span class="pl-p">{};</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">})();</span></span></span></code></pre><p>or (recommended)</p><pre class="pl-chroma"><code><span class="pl-line"><span class="pl-cl"><span class="pl-c1">// app.js
</span></span></span><span class="pl-line"><span class="pl-cl"><span class="pl-c1"></span><span class="pl-p">;(</span><span class="pl-kd">function</span><span class="pl-p">(</span><span class="pl-nx">scope</span><span class="pl-p">)</span> <span class="pl-p">{</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-nx">scope</span><span class="pl-p">.</span><span class="pl-nx">WeatherApp</span> <span class="pl-o">=</span> <span class="pl-p">{};</span>
</span></span><span class="pl-line"><span class="pl-cl">  <span class="pl-nx">scope</span><span class="pl-p">.</span><span class="pl-nx">WeatherApp</span><span class="pl-p">.</span><span class="pl-nx">router</span> <span class="pl-o">=</span> <span class="pl-p">{};</span>
</span></span><span class="pl-line"><span class="pl-cl"><span class="pl-p">})(</span><span class="pl-k">this</span><span class="pl-p">);</span></span></span></code></pre><p>This last method allows you to use this code and pass in any contextual scope. Since <code>this</code> is equivalent to <code>window</code> at the global level, when you run this in the browser, <code>this</code> is <code>window</code>, so <code>WeatherApp</code> will be added to the <code>window</code> global.</p><p>When you leave out the <code>var</code>, you create a global variable, so be careful! I recommend being explicit with to what object you are adding a <code>namespace</code>. If you‚Äôre going the global variable route, then you should nest every single thing you‚Äôre doing inside of your <code>WeatherApp</code> namespace in order to avoid having more than 1 global variable.</p><h2 id="conclusion">Conclusion</h2><p>This is a great pattern to utilize when you have relatively simple JavaScript you would like to add to a webpage and not have its contents clash with other libraries &amp; code. If your code begins to get too complicated for this file, then we can start to look at the <a href="http://wiki.commonjs.org/wiki/Modules/1.1">CommonJS module exporting &amp; requiring pattern</a> that is currently implemented by the wonderful <a href="http://browserify.org">Browserify</a> library (aka, Node.js but in the browser). I may cover this in the future, but in the mean time, leverage the power of immediate functions for great good!</p></section></main><footer><span aria-hidden="true" class="heart">‚ô•</span><span aria-hidden="true">&rarr;</span><a href="https://github.com/sponsors/rpearce/">Sponsor my work</a><span aria-hidden="true">&larr;</span><span aria-hidden="true" class="heart">‚ô•</span></footer><script async> (() => { const themeEl = document.querySelector('[data-select-theme]'); if (themeEl) { themeEl.querySelector('[value="'+window.site.prefTheme+'"]').selected = 'selected'; themeEl.addEventListener('change', e => { window.site.setTheme(e.target.value); }); } const fontEl = document.querySelector('[data-select-font]'); if (fontEl) { fontEl.querySelector('[value="'+window.site.prefFont+'"]').selected = 'selected'; fontEl.addEventListener('change', e => { window.site.setFont(e.target.value); }) } })(); </script></body></html>