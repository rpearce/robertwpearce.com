<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Simple Variadic Behavior</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Beginner-friendly introduction to variadic behavior.">
    <meta name="author" content="Robert Pearce">
    <meta name="keywords" content="javascript, javascript tutorial, variadic behavior, function arguments, variable arguments, function parameters">
    <meta name="google-site-verification" content="QX4bn65yOXBfgnwxlO09yIBc1H8blur-Erx3lmsDVhU">

    <meta property="og:site_name" content="Robert Pearce | Senior Software Developer">
    <meta property="og:title" content="Simple Variadic Behavior">
    <meta property="og:url" content="https://robertwpearce.com/simple-variadic-behavior.html">
    <meta property="og:description" content="Beginner-friendly introduction to variadic behavior.">
    <meta property="og:image" content="https://robertwpearce.com/images/waterfall.jpg">
    
      <meta property="og:type" content="article">
    

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:site" content="Robert Pearce | Senior Software Developer">
    <meta property="twitter:title" content="Simple Variadic Behavior">
    <meta property="twitter:description" content="Beginner-friendly introduction to variadic behavior.">
    <meta property="twitter:image" content="https://robertwpearce.com/images/waterfall.jpg">
    <meta property="twitter:creator" content="@RobertWPearce">

    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="canonical" href="https://robertwpearce.com/simple-variadic-behavior.html">
    <link rel="stylesheet" href="/css/default.css" />
    
      <link rel="stylesheet" href="/css/article.css" />
    
  </head>
  <body class="light">
    <nav class="nav">
  <div class="layout--constrained">
    <a class="nav__link nav__skip" href="#content">Skip to content</a>
    <a class="nav__link" href="/">Home</a>
    <a class="nav__link" href="mailto:me@robertwpearce.com?subject=Work Inquiry">Hire Me</a>
    <a class="nav__link" href="/atom.xml">atom</a>
    <a class="nav__link" href="/rss.xml">rss</a>
  </div>
</nav>


<main id="content" tabindex="-1">
  <article class="article">
    <header class="article__bg" style="background-image: url('/images/waterfall.jpg')">
      <div class="article__bgHeader">
        <div class="layout--constrained">
          <div class="article__bgTitleWrap">
            <h1 class="article__bgTitle">
              <a href="/simple-variadic-behavior.html">Simple Variadic Behavior</a>
            </h1>
            <div class="article__bgSubHeader">
              <small class="italic">2015-10-13</small>
              
              
            </div>
          </div>
        </div>
      </div>
    </header>
    <section class="layout--constrained">
      <header class="article__header">
        <h1 class="article__title">
          <a href="/simple-variadic-behavior.html">Simple Variadic Behavior</a>
        </h1>
        <small class="italic">2015-10-13</small>
        
      </header>
      <p style="text-decoration:line-through;">Recently, I have started working on my own static site generator, [react-static](https://github.com/rpearce/react-static), to accomodate my markdown blog posting & static site needs. Another benefit is that I get to work on my Node.js and ES2015+ JavaScript skills. While I am reinventing the wheel on some levels, it is good practice.</p>
<p><strong>Update</strong>: I made a library, <a href="https://www.npmjs.com/package/parse-md">parse-md</a>, out of some of this behavior in order to address the need of parsing metadata from markdown files.</p>
<p>My latest problem to solve was how, once I had a <code>.md</code> (Markdown) file’s contents, to go about parsing out the blog post’s metadata (see below: the key/value pairs between the two <code>---</code>s).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a>---</span>
<span id="cb1-2"><a href="#cb1-2"></a>title: This is a test</span>
<span id="cb1-3"><a href="#cb1-3"></a>description: Once upon a time, there was a test...</span>
<span id="cb1-4"><a href="#cb1-4"></a>---</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu"># Title of my great post</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>Lorem ipsum dolor...</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">## Some heading</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>Bacon ipsum...</span></code></pre></div>
<p>Once I <code>split</code> this file based on newlines, I needed a way of finding the indices of the metadata boundary, <code>---</code>, so that I could <code>splice</code> the array in to two pieces and be on my way. My first attempt at getting the indices looked like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">function</span> <span class="at">getMetadataIndices</span>(lines) <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="kw">var</span> arr <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="va">lines</span>.<span class="at">forEach</span>((line<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    <span class="cf">if</span> (<span class="ss">/</span><span class="sc">^</span><span class="ss">---/</span>.<span class="at">test</span>(line)) <span class="op">{</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>      <span class="va">arr</span>.<span class="at">push</span>(i)<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="op">}</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="cf">return</span> arr<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="op">}</span></span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="at">getMetadataIndices</span>(lines)<span class="op">;</span> <span class="co">// [0, 3]</span></span></code></pre></div>
<p>This is a simple solution that any junior dev can do, and it accomplishes the task… but it doesn’t feel right. I am iterating over each item, testing each line and mutating an array variable when a condition is true. While it doesn’t look like much, that is a good bit going on all at once. Instinct tells me that each action could be its own simple method. I also don’t want to use a temporary variable that I mutate. However, this removes <code>forEach</code> from our options, as <code>forEach</code> returns the original array. <code>map()</code> to the rescue! (or so we think).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">function</span> <span class="at">getMetadataIndices</span>(lines) <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="cf">return</span> <span class="va">lines</span>.<span class="at">map</span>(testForBoundary)<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="op">}</span></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">function</span> <span class="at">testForBoundary</span>(item<span class="op">,</span> i) <span class="op">{</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">^</span><span class="ss">---/</span>.<span class="at">test</span>(item)) <span class="op">{</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="op">}</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="op">}</span></span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="at">getMetadataIndices</span>(lines)<span class="op">;</span> <span class="co">// [0, undefined, undefined, 3, undefined, undefined, undefined, undefined, undefined, undefined]</span></span></code></pre></div>
<p>Crap. Because I only return when the test is true, <code>map</code> doesn’t know what to return, so it returns <code>undefined</code> and moves on. It would be nice if we could clean out these <code>undefined</code>s!</p>
<h2 id="cleaning-up-our-array">Cleaning Up Our Array</h2>
<p>How can we achieve the following desired functionality?</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">function</span> <span class="at">getMetadataIndices</span>(lines) <span class="op">{</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="cf">return</span> <span class="va">lines</span>.<span class="at">map</span>(testForBoundary).<span class="at">clean</span>(<span class="kw">undefined</span>)<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="op">}</span></span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="at">getMetadataIndices</span>(lines)<span class="op">;</span> <span class="co">// [0, 3]</span></span></code></pre></div>
<p>Let’s make a function on the <code>prototype</code> of <code>Array</code> called <code>clean</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1"></a><span class="va">Array</span>.<span class="va">prototype</span>.<span class="at">clean</span> <span class="op">=</span> <span class="kw">function</span>(trash) <span class="op">{</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="op">};</span></span></code></pre></div>
<p>Here, we access <code>Array</code>’s <code>prorotype</code> and add our own custom method, <code>clean</code> and pass it one argument. Next, we need to <code>filter</code> out all of the <code>undefined</code>s in our array.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1"></a><span class="va">Array</span>.<span class="va">prototype</span>.<span class="at">clean</span> <span class="op">=</span> <span class="kw">function</span>(trash) <span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="cf">return</span> <span class="kw">this</span>.<span class="at">filter</span>(item <span class="kw">=&gt;</span> item <span class="op">!==</span> trash)<span class="op">;</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="op">};</span></span></code></pre></div>
<p>But what if we need to clean more than one value out? What if we need to clean <code>null</code>, <code>""</code> and <code>undefined</code>?</p>
<h2 id="variadic-behavior">Variadic Behavior</h2>
<p>In JavaScript, <em>variadic behavior</em> is a fancy term applied to functions that can accept and handle any number of arguments, and these are typically accessed within the function via the <code>arguments</code> object, which looks like an <code>Array</code> but is <em>not</em>. For example, this code will give you an error about <code>indexOf</code> not being defined on <code>arguments</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1"></a><span class="va">Array</span>.<span class="va">prototype</span>.<span class="at">clean</span> <span class="op">=</span> <span class="kw">function</span>(trash) <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="cf">return</span> <span class="kw">this</span>.<span class="at">filter</span>(item <span class="kw">=&gt;</span> <span class="kw">arguments</span>.<span class="at">indexOf</span>(item) <span class="op">===</span> <span class="dv">-1</span>)<span class="op">;</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="op">};</span></span></code></pre></div>
<p>Drats! <code>arguments</code> is very similar to an array — how can we get this to work? <code>slice</code> to the rescue!</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1"></a><span class="va">Array</span>.<span class="va">prototype</span>.<span class="at">clean</span> <span class="op">=</span> <span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="kw">const</span> args <span class="op">=</span> [].<span class="va">slice</span>.<span class="at">call</span>(<span class="kw">arguments</span>)<span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="cf">return</span> <span class="kw">this</span>.<span class="at">filter</span>(item <span class="kw">=&gt;</span> <span class="va">args</span>.<span class="at">indexOf</span>(item) <span class="op">===</span> <span class="dv">-1</span>)<span class="op">;</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="op">};</span></span></code></pre></div>
<p>Without any additional arguments, <code>slice</code> makes a copy of an array and allows us to provide a custom receiver of array-like functionality: <code>arguments</code>. What is returned from the second line above is an array-ized <em>copy</em> of <code>arguments</code>. Now that <code>args</code> is an array of all the arguments that are passed to <code>clean</code>, we can pass as many options as we would like to clean out our array!</p>
<p>Here is more example usage of such a method:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">// Usage</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">const</span> arr <span class="op">=</span> [<span class="st">&quot;&quot;</span><span class="op">,</span> <span class="kw">undefined</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="st">&quot;yes&quot;</span><span class="op">,</span> <span class="kw">undefined</span><span class="op">,</span> <span class="kw">undefined</span><span class="op">,</span> <span class="st">&quot;&quot;</span>]<span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="va">arr</span>.<span class="at">clean</span>(<span class="kw">undefined</span>)<span class="op">;</span> <span class="co">// [&quot;&quot;, 3, &quot;yes&quot;, &quot;&quot;];</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="va">arr</span>.<span class="at">clean</span>(<span class="kw">undefined</span><span class="op">,</span> <span class="st">&quot;&quot;</span>)<span class="op">;</span> <span class="co">// [3, &quot;yes&quot;];</span></span></code></pre></div>
<h2 id="all-together">All Together</h2>
<p>In attempting to refactor some fairly simple, though multiple-responsibility code, we end up creating a few reusable functions that will benefit us in the future, and we make our code more maintainable, testable and readable in the end. Here it is once we have finished:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">function</span> <span class="at">getMetadataIndices</span>(lines) <span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="cf">return</span> <span class="va">lines</span>.<span class="at">map</span>(testForBoundary).<span class="at">clean</span>(<span class="kw">undefined</span>)<span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="op">}</span></span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="kw">function</span> <span class="at">testForBoundary</span>(item<span class="op">,</span> i) <span class="op">{</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">^</span><span class="ss">---/</span>.<span class="at">test</span>(item)) <span class="op">{</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="op">}</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="op">}</span></span>
<span id="cb10-10"><a href="#cb10-10"></a></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="va">Array</span>.<span class="va">prototype</span>.<span class="at">clean</span> <span class="op">=</span> <span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="kw">const</span> args <span class="op">=</span> [].<span class="va">slice</span>.<span class="at">call</span>(<span class="kw">arguments</span>)<span class="op">;</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>  <span class="cf">return</span> <span class="kw">this</span>.<span class="at">filter</span>(item <span class="kw">=&gt;</span> <span class="va">args</span>.<span class="at">indexOf</span>(item) <span class="op">===</span> <span class="dv">-1</span>)<span class="op">;</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="op">};</span></span></code></pre></div>
<p>But could this be done <em>even</em> simpler?</p>
<h2 id="ps-use-reduce-next-time">p.s. Use reduce next time</h2>
<p>You may have been wondering why we didn’t use <code>reduce</code> like this from the start:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1"></a><span class="va">lines</span>.<span class="at">reduce</span>(<span class="kw">function</span>(mem<span class="op">,</span> item<span class="op">,</span> i) <span class="op">{</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">^</span><span class="ss">---/</span>.<span class="at">test</span>(item)) <span class="op">{</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>    <span class="va">mem</span>.<span class="at">push</span>(i)<span class="op">;</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="op">}</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="cf">return</span> mem<span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>or, cleaned up a bit,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">function</span> <span class="at">getMetadataIndices</span>(mem<span class="op">,</span> item<span class="op">,</span> i) <span class="op">{</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">^</span><span class="ss">---/</span>.<span class="at">test</span>(item)) <span class="op">{</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>    <span class="va">mem</span>.<span class="at">push</span>(i)<span class="op">;</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="op">}</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="cf">return</span> mem<span class="op">;</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="op">}</span></span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="va">lines</span>.<span class="at">reduce</span>(getMetadataIndices<span class="op">,</span> [])<span class="op">;</span></span></code></pre></div>
<p>Surprise! We totally could have, but since <code>reduce</code> was not our first thought when refactoring, we managed to solve our problem in another way. There are 1000 ways to solve problems, and sometimes you don’t think of the best one first, but you can still make the best with what you have at the time and refactor later.</p>
    </section>
  </article>
</main>

<footer>
  <section class="subscribe section--padded">
  <div class="layout--constrained">
    <h2 class="subscribe__header">Get notified of new posts</h2>

    <form action="//robertwpearce.us13.list-manage.com/subscribe/post?u=2df44e8960266388bff165fa6&amp;id=ee2f2a3737" method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate class="subscribe__form">
      <div style="position: absolute; left: -5000px;" aria-hidden="true">
        <input type="text" name="b_2df44e8960266388bff165fa6_ee2f2a3737" tabindex="-1" value="">
      </div>
      <div class="subscribe__section">
        <input type="email" value="" id="mce-EMAIL" class="subscribe__input" name="EMAIL" placeholder="you@greatemail.com" aria-label="Email Address">
        <input type="submit" value="Subscribe" name="subscribe" class="subscribe__submit">
      </div>
      <small>Note: I will <em>never</em> give out your email nor spam you. Unsubscribe at any time.</small>
    </form>
    <p>
      <small>(or subscribe to the <a href="/atom.xml" class="subscribe__link">atom</a> or <a class="subscribe__link" href="/rss.xml">rss</a> feeds)</small>
    </p>
  </div>
</section>

</footer>

    <script async src="/js/index.js"></script>
  </body>
</html>
