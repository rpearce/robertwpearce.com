<!DOCTYPE html><html lang="en"><head><title>Ramda Chops: Map, Filter & Reduce</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta name="description" content="How to use ramda's map, filter and reduce functions to filter and transform a list of popular films."><meta property="og:site_name" content="Robert Pearce | Freelance Software Developer"><meta property="og:title" content="Ramda Chops: Map, Filter & Reduce"><meta property="og:url" content="https://robertwpearce.com/blog/ramda-chops-map-filter-and-reduce.html"><meta property="og:description" content="How to use ramda's map, filter and reduce functions to filter and transform a list of popular films."><meta property="og:image" content="/images/sheep-cliffs.jpg"><meta property="og:type" content="article"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="Robert Pearce | Freelance Software Developer"><meta property="twitter:title" content="Ramda Chops: Map, Filter & Reduce"><meta property="twitter:description" content="How to use ramda's map, filter and reduce functions to filter and transform a list of popular films."><meta property="twitter:image" content="/images/sheep-cliffs.jpg"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://robertwpearce.com/blog/ramda-chops-map-filter-and-reduce.html"><link rel="stylesheet" href="/styles.css"><meta name="google-site-verification" content="QX4bn65yOXBfgnwxlO09yIBc1H8blur-Erx3lmsDVhU"><link href="//fonts.googleapis.com/css?family=Lato:400" rel="stylesheet" type="text/css"></head><body><main><nav><div class="layout--constrained"><ul class="nav--main list--bare list--horz"><li><a href="/">Home</a></li><li><a href="mailto:me@robertwpearce.com?subject=Work Inquiry">Hire Me</a></li></ul></div></nav><article class="article"><div class="article__background" style="background-image: url('/images/sheep-cliffs.jpg')"><header class="article__bgHeader"><div class="layout--constrained"><div class="article__bgTitleContainer"><h1 class="heading--trim"><a href="/blog/ramda-chops-map-filter-and-reduce.html">Ramda Chops: Map, Filter & Reduce</a></h1><div class="article__subHeader"><small>Feb 8, 2018</small> <small class="photoCred">[photo credit <a href="https://unsplash.com/@cosmin_13">Mingheras Cosmin</a>]</small></div></div></div></header></div><div class="layout--constrained"><header class="article__header heading--fatBottomBorder"><h1 class="heading--trim"><a href="/blog/ramda-chops-map-filter-and-reduce.html">Ramda Chops: Map, Filter & Reduce</a></h1><small>Feb 8, 2018</small></header><p><em>Thanks to <a href="https://github.com/jsilve">Jillian Silver</a>, <a href="https://patrickweakin.com">Patrick Eakin</a> and <a href="https://twitter.com/zerkms">@zerkms</a> for their review of this post.</em></p><p>The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map"><code>map</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter"><code>filter</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce"><code>reduce</code></a> methods on <code>Array.prototype</code> are essential to adopting a functional programming style in JavaScript, and in this post we&#39;re going to examine how to use these three concepts with <a href="http://ramdajs.com/">ramda.js</a>.</p><p>If you are unfamiliar with these three concepts, then be sure to first read the MDN documentation on each (linked above).</p><hr><p><em>Pre-requisite ramda posts:</em></p><ul><li><a href="/blog/ramda-chops-function-currying.html">Ramda Chops: Function Currying</a></li><li><a href="/blog/ramda-chops-function-composition.html">Ramda Chops: Function Composition</a></li></ul><p><em>Other ramda posts:</em></p><ul><li><a href="/blog/ramda-chops-safely-accessing-properties.html">Ramda Chops: Safely Accessing Properties</a></li></ul><h2><a class="heading--link" name="our-data-set-films-" href="#our-data-set-films-"><span>Our Data Set: Films!</span></a></h2><p>This is the test data set we will reference throughout the post:</p><pre><code class="hljs js"><span class="hljs-keyword">const</span> films = [
  { <span class="hljs-attr">title</span>: <span class="hljs-string">'The Empire Strikes Back'</span>, <span class="hljs-attr">rating</span>: <span class="hljs-number">8.8</span> },
  { <span class="hljs-attr">title</span>: <span class="hljs-string">'Pulp Fiction'</span>, <span class="hljs-attr">rating</span>: <span class="hljs-number">8.9</span> },
  { <span class="hljs-attr">title</span>: <span class="hljs-string">'The Deer Hunter'</span>, <span class="hljs-attr">rating</span>: <span class="hljs-number">8.2</span> },
  { <span class="hljs-attr">title</span>: <span class="hljs-string">'The Lion King'</span>, <span class="hljs-attr">rating</span>: <span class="hljs-number">8.5</span> }
]</code></pre><h2><a class="heading--link" name="our-goal" href="#our-goal"><span>Our Goal</span></a></h2><p>There are a few conditions that are required for us to meet our goal. We must construct a function that:</p><ul><li>only selects those with an 8.8 rating or higher</li><li>returns a list of the selected titles interpolated in an HTML string that has this structure:<pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>TITLE: <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>SCORE<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></li></ul><p>Given these requirements, a pseudotype signature for this might be:</p><pre><code class="hljs js"><span class="hljs-comment">// `output` takes in a list of films</span>
<span class="hljs-comment">// and returns a list of HTML strings</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// output :: [Film] -&gt; [Html]</span></code></pre><h2><a class="heading--link" name="step-1-get-the-html-part-working" href="#step-1-get-the-html-part-working"><span>Step 1: Get the HTML Part Working</span></a></h2><pre><code class="hljs js">films.map(<span class="hljs-function"><span class="hljs-params">film</span> =&gt;</span> <span class="hljs-string">`&lt;div&gt;<span class="hljs-subst">${film.title}</span>, &lt;strong&gt;<span class="hljs-subst">${film.rating}</span>&lt;/strong&gt;&lt;/div&gt;`</span>)
<span class="hljs-comment">// =&gt; [</span>
<span class="hljs-comment">//      "&lt;div&gt;The Empire Strikes Back, &lt;strong&gt;8.8&lt;/strong&gt;&lt;/div&gt;",</span>
<span class="hljs-comment">//      "&lt;div&gt;Pulp Fiction, &lt;strong&gt;8.9&lt;/strong&gt;&lt;/div&gt;",</span>
<span class="hljs-comment">//      "&lt;div&gt;The Deer Hunter, &lt;strong&gt;8.2&lt;/strong&gt;&lt;/div&gt;",</span>
<span class="hljs-comment">//      "&lt;div&gt;The Lion King, &lt;strong&gt;8.5&lt;/strong&gt;&lt;/div&gt;"</span>
<span class="hljs-comment">//    ]</span></code></pre><p><em><a href="https://goo.gl/mQmFBm">Try this code in the ramda REPL</a></em></p><h2><a class="heading--link" name="step-2-extract-the-code-map-code-callback" href="#step-2-extract-the-code-map-code-callback"><span>Step 2: Extract the <code>map</code> Callback</span></a></h2><pre><code class="hljs js"><span class="hljs-comment">// filmHtml :: Film -&gt; Html</span>
<span class="hljs-keyword">const</span> filmHtml = <span class="hljs-function"><span class="hljs-params">film</span> =&gt;</span>
  <span class="hljs-string">`&lt;div&gt;<span class="hljs-subst">${film.title}</span>, &lt;strong&gt;<span class="hljs-subst">${film.rating}</span>&lt;/strong&gt;&lt;/div&gt;`</span>

films.map(filmHtml)</code></pre><p><em><a href="https://goo.gl/C4a1kZ">Try this code in the ramda REPL</a></em></p><h2><a class="heading--link" name="step-3-code-filter-code-out-lower-scores" href="#step-3-code-filter-code-out-lower-scores"><span>Step 3: <code>filter</code> Out Lower Scores</span></a></h2><pre><code class="hljs js">films
  .filter(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x.rating &gt;= <span class="hljs-number">8.8</span>)
  .map(filmHtml)

<span class="hljs-comment">// =&gt; [</span>
<span class="hljs-comment">//      "&lt;div&gt;The Empire Strikes Back, &lt;strong&gt;8.8&lt;/strong&gt;&lt;/div&gt;",</span>
<span class="hljs-comment">//      "&lt;div&gt;Pulp Fiction, &lt;strong&gt;8.9&lt;/strong&gt;&lt;/div&gt;",</span>
<span class="hljs-comment">//    ]</span></code></pre><p><em><a href="https://goo.gl/yTxfKQ">Try this code in the ramda REPL</a></em></p><p>But wait! We can extract that <code>filter</code> callback, as well:</p><pre><code class="hljs js"><span class="hljs-comment">// hasHighScore :: Film -&gt; Bool</span>
<span class="hljs-keyword">const</span> hasHighScore = <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span>
  x.rating &gt;= <span class="hljs-number">8.8</span>

films
  .filter(hasHighScore)
  .map(filmHtml)</code></pre><p><em><a href="https://goo.gl/qG4kZ7">Try this code in the ramda REPL</a></em></p><h2><a class="heading--link" name="step-4-composing-code-filter-code-and-code-map-code-" href="#step-4-composing-code-filter-code-and-code-map-code-"><span>Step 4: Composing <code>filter</code> and <code>map</code></span></a></h2><p>We can use ramda&#39;s <a href="/blog/ramda-chops-function-currying.html">function currying capabilities</a> and <a href="/blog/ramda-chops-function-composition.html">function composition</a> to create some very clear and concise <a href="https://wiki.haskell.org/Pointfree">pointfree functions</a>.</p><pre><code class="hljs js"><span class="hljs-keyword">import</span> { compose, filter, map } <span class="hljs-keyword">from</span> <span class="hljs-string">'ramda'</span>

<span class="hljs-comment">// output :: [Film] -&gt; [Html]</span>
<span class="hljs-keyword">const</span> output =
  compose(map(filmHtml), filter(hasHighScore))

output(films)</code></pre><p><em><a href="https://goo.gl/7VMNTV">Try this code in the ramda REPL</a></em></p><p>One thing to remember with ramda functions (like <code>map</code> and <code>filter</code>) is that ramda typically orders arguments from least likely to change to most likely to change. Callback/transformation functions here are passed as the <em>first</em> argument, and the data comes last. To understand this further, check out the following links:</p><ul><li><a href="http://ramdajs.com/docs/#map">ramda&#39;s documentation for <code>map</code></a></li><li><a href="http://ramdajs.com/docs/#filter">ramda&#39;s documentation for <code>filter</code></a></li></ul><h2><a class="heading--link" name="step-5-extracting-the-composition-further" href="#step-5-extracting-the-composition-further"><span>Step 5: Extracting The Composition Further</span></a></h2><p>If we want to not only reuse our filtering and mapping functions but also make them more readable, we can pull out the pieces that make up our <code>output</code> function into smaller bits:</p><pre><code class="hljs js"><span class="hljs-comment">// filmsToHtml :: [Film] -&gt; [Html]</span>
<span class="hljs-keyword">const</span> filmsToHtml =
  map(filmHtml)

<span class="hljs-comment">// highScores :: [Film] -&gt; [Film]</span>
<span class="hljs-keyword">const</span> highScores =
  filter(hasHighScore)

<span class="hljs-comment">// output :: [Film] -&gt; [Html]</span>
<span class="hljs-keyword">const</span> output =
  compose(filmsToHtml, highScores)

output(films)</code></pre><p><em><a href="https://goo.gl/dFXCEK">Try this code in the ramda REPL</a></em></p><h2><a class="heading--link" name="step-6-another-way-with-code-reduce-code-" href="#step-6-another-way-with-code-reduce-code-"><span>Step 6: Another Way With <code>reduce</code></span></a></h2><p>We can accomplish the same goals as <code>filter</code> and <code>map</code> by making use of <code>reduce</code>.</p><pre><code class="hljs js">films.reduce(<span class="hljs-function">(<span class="hljs-params">acc, x</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> hasHighScore(x)
    ? acc.concat(filmHtml(x))
    : acc
}, [])

<span class="hljs-comment">// or, for better performance</span>

films.reduce(<span class="hljs-function">(<span class="hljs-params">acc, x</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (hasHighScore(x)) {
    acc.push(filmHtml(x))
  }

  <span class="hljs-keyword">return</span> acc
}, [])</code></pre><p><em><a href="https://goo.gl/b86Kdq">Try this code in the ramda REPL</a></em></p><p>If you&#39;re not familiar with reduce, be sure to play with the live example to better understand how those pieces work before moving on.</p><p>It&#39;s also worth noting that you can do just about <em>anything</em> in JavaScript with the <code>reduce</code> function. I highly recommend going through <a href="https://twitter.com/kylehill">Kyle Hill</a>&#39;s slides on <a href="https://omnifunction.herokuapp.com">reduce Is The Omnifunction</a>.</p><p>But wait! We can extract the <code>reduce</code> callback like we did with <code>map</code> and <code>filter</code> before:</p><pre><code class="hljs js"><span class="hljs-comment">// highScoresHtml :: ([Html], Film) -&gt; [Html]</span>
<span class="hljs-keyword">const</span> highScoresHtml = <span class="hljs-function">(<span class="hljs-params">acc, x</span>) =&gt;</span>
  hasHighScore(x)
    ? acc.concat(filmHtml(x))
    : acc

films.reduce(highScoresHtml, [])</code></pre><p><em><a href="https://goo.gl/F6NovJ">Try this code in the ramda REPL</a></em></p><h2><a class="heading--link" name="step-7-making-our-reduce-arguments-reusable" href="#step-7-making-our-reduce-arguments-reusable"><span>Step 7: Making Our Reduce Arguments Reusable</span></a></h2><pre><code class="hljs js"><span class="hljs-keyword">import</span> { reduce } <span class="hljs-keyword">from</span> <span class="hljs-string">'ramda'</span>

<span class="hljs-keyword">const</span> output =
  reduce(highScoresHtml, [])

output(films)</code></pre><p><em><a href="https://goo.gl/wjbAFY">Try this code in the ramda REPL</a></em></p><p>As before with <code>map</code> &amp; <code>filter</code>, <code>output</code> can be reused over and over again and passed any set of films to generate HTML for. To further understand the parameter order used here, check out the <a href="http://ramdajs.com/docs/#reduce">docs for ramda&#39;s <code>reduce</code></a>.</p><hr><p>This step-by-step process we&#39;ve walked through is as close to real-life refactoring/rethinking as I could do in a post. Thanks for making it this far.</p><p>Until next time,<br>Robert</p></div></article><section class="section--padded bg--gray"><div class="layout--constrained"><h2>Get notified of new posts</h2><!-- Begin MailChimp Signup Form --><form action="//robertwpearce.us13.list-manage.com/subscribe/post?u=2df44e8960266388bff165fa6&amp;id=ee2f2a3737" method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate class="form"><div id="mce-responses"><div class="response" id="mce-error-response" style="display:none"></div><div class="response" id="mce-success-response" style="display:none"></div></div><div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_2df44e8960266388bff165fa6_ee2f2a3737" tabindex="-1" value=""></div><div class="form__container"><label for="mce-EMAIL" class="form__label">Email Address</label> <input type="email" value="" id="mce-EMAIL" class="form__input" name="EMAIL" placeholder="you@greatemail.com"> <input type="submit" value="Subscribe" name="subscribe" class="form__submit"></div><small>Note: I will <em>never</em> give out your email nor spam you. Unsubscribe at any time.</small></form><!--End mc_embed_signup--></div></section></main></body></html>